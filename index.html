<!DOCTYPE html>
<html>
  <body>


    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"></script>
    <script type="text/javascript">

var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSa7yx5pA0NsTg4CCK1LV7Xi7j-tnUE4Ap7jpHY1S50C7nhUQgeOD3ib12kh09qt-fEFMCQS6RIfH8C/pubhtml';

  function init() {
        Papa.parse(publicSpreadsheetUrl, {
          download: true,
          header: true,
          complete: showInfo
        })
      }

      window.addEventListener('DOMContentLoaded', init)

function showInfo(data, tabletop) {


   console.log(data);

   var strDryerStatus = "";
   var strWasherStatus = "";


	for (var i = 0; i < data.length; i++) {
        console.log(data[i].appliance);

        if(data[i].appliance === "Dryer")
        {
         	strDryerStatus = data[i].status;
         }
         else if (data[i].appliance === "Washer"){
         	strWasherStatus = data[i].status;
         }

    }

   document.getElementById("dryerStatus").innerHTML = strDryerStatus;
   document.getElementById("washerStatus").innerHTML = strWasherStatus;

   var cells = document.getElementById("appstatus").getElementsByTagName("td");

for (var i = 0; i < cells.length; i++)
{
    if (cells[i].innerHTML == "In Use")
    {
        cells[i].style.backgroundColor = "red";
    }
    else if (cells[i].innerHTML == "Available")
    {
        cells[i].style.backgroundColor = "#85e085"
    }
}
}

  window.addEventListener('DOMContentLoaded', init)

</script>
<table id="appstatus"">
<tr><td>Dryer</td><td> </td><td>Washer</td></tr>
<tr><td><img src="dryer.jpg" style="width:228px;height:280px;"></td><td> </td>
<td><img src="washingmachine.jpg" style="width:228px;height:280px;"></td></tr>
<tr>
<tr><td id="dryerStatus" ></td><td></td><td id="washerStatus"></td></tr>

<button onClick="window.location.reload();">Refresh Page</button>

    </body>
 <style>
    #appstatus {
  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  font-size:32px;
  border-collapse: collapse; text-align:center;
  width: 100%;

}
</style>
</html>
